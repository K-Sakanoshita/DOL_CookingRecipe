<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="stylesheet" type="text/css" href="cooking.css">
	<link rel="shortcut icon" href="tmfav14001.ico" >
	<link rel="search" type="application/opensearchdescription+xml" title="大航海時代Online(調理レシピ検索+)" href="OpenSearch(cooking).xml">
	<title>大航海時代Online(調理レシピ検索+)</title>
	<meta name="description" content="大航海時代Onlineの調理レシピを材料から検索するサイトです。">
	<script type="text/javascript" src="ecl.js"></script>
	<script type="text/javascript" src="prototype.js"></script>
	<script type="text/javascript" src="data.js"></script>
	<script type="text/javascript" src="metarial.js"></script>
	<script type="text/javascript" src="recipe.js"></script>
	<script type="text/javascript">
		// Global変数の設定
		Meta    = new Metarial();
		Recipe  = new Recipe();
		var OldKey = "";

		// 関数:キーワード検索(空の時は全レシピ表示)
		function KeySearch(Keyword){
			var SType = "";
			var i     = 0;

			for(i = 0; i < document.MetaOneForm.SearchMethod.length; i++){	// ラジオボタンチェック
				if(document.MetaOneForm.SearchMethod[i].checked) {
					SType = document.MetaOneForm.SearchMethod[i].value;
					break;
				};
			};
			OldKey = document.MetaOneForm.MetaOne.value;
			document.MetaOneForm.MetaOne.value = Keyword;
			Recipe.FList = Recipe.SearchOne(Keyword,SType);
			Recipe.SortResults('','');
			WriteAnswer("on");
		};

		// 関数:一致検索と関連検索
		function RecipeSearch(SType){
			var MList = new Array();
			MList = Meta.GetSelectList(window);
			Recipe.SearchAll(MList,SType);
			Recipe.SortResults('','');
			WriteAnswer("on");
		};

		// 関数:全ての引数を連想配列に入力
		function GetAllQuery() {
			var Query  = new Array();
			var qtext  = window.location.search.substring(1);
			var parms = qtext.split('&');
			for (var i = 0; i < parms.length; i++) {
				var pos = parms[i].indexOf('=');
				if (pos > 0) {
					var key = parms[i].substring(0,pos);
					var str = parms[i].substring(pos + 1);
					str = window["Unescape"+GetEscapeCodeType(str)](str);
					Query[key] = str;
				};
			};
			return Query;
		};

		// 関数:キーワードを所有交易品欄へ追加
		function AddMetarial(MName){
			Meta.SetSelectList(MName);
		}

		// 関数:所有交易品一覧の消去
		function ClearAllSelect(){
			if(window.confirm('所有交易品の一覧を全て削除しますか？')){
				Meta.ClearSelectList();
			};
		};

		// 関数:選択交易品の消去
		function ClearSelectItem(num){
				Meta.ClearSelectItem(num);
		}
		
		// 関数:全てのレシピを一覧表示
		function ViewAllRecipe() {
			var elm = document;
			var ref = elm.getElementsByName('Refine');
			var act = elm.getElementById('Action');
			var i = 0;
			
			for (i = 0 ; i < ref.length ; i++){		// 絞り込みオプションの初期化
				ref[i].checked = ref[i].defaultChecked
			};

			for (i = 0 ; i < act.length ; i++){		// 回復量オプションの初期化
				act[i].selected = act[i].defaultSelected
			};
			
			document.getElementById('part').checked=true;
			KeySearch('');
		};

		// 検索結果の画面表示
		function WriteAnswer(RType) {
			var y   = 0;
			var elm = document;
			var ans = elm.getElementById('Answer1');
			var ref = elm.getElementsByName('Refine');
			var act = elm.getElementById('Action').value;
			Recipe.WriteAns(ans,RType,ref,act);
		};
	</script>
	</head>

	<body>
	<div id="wrap">  
		<h1><img src="./logo.png" style="padding: 2px 0px"></h1>
		<div id="sidebar">
			<form name="MetaOneForm" onSubmit="KeySearch(document.MetaOneForm.MetaOne.value);return false;">
				<h2><a href="../wiki/wiki.cgi?page=GVOnline">問題/要望受付</a></h2>
				<h3>キーワード検索</h3>
				<div class="Sidebar">
					<div style="clear: both">
						<input name="MetaOne" value="" type="text" style="width:90%; margin: 1%">
						<input value="検索" type="submit" style="width:24%; float: left; margin: 1%">
						<input value="戻る" type="button" style="width:24%; float: left; margin: 1%" onClick="KeySearch(OldKey)">
						<input type="button" value="消去" style="width:24%; float: left; margin: 1%" onClick="ViewAllRecipe()">
					</div>
					<div style="clear: both"><input type="radio" name="SearchMethod" id="part" value="part" style=" margin: 3%; float: left;" checked><label for="radio">部分一致</label>
					<input type="radio" name="SearchMethod" id="full" value="full" style=" margin: 3%" ><label for="full">完全一致</label></div>
					<hr>
					<input value="大商戦" style="clear: both" type="button" onClick="
						obj=document.MetaOneForm;
						window.open('http://dol.egret.jp/gtf/?page=serch&object=' + EscapeEUCJP(obj.MetaOne.value))
						">
					<select name="Goodle" onchange="
						obj=document.MetaOneForm;
						if (obj.Goodle.value != '0'){
							window.open('http://dol.vc/search.php?q=' + EscapeUTF8(obj.MetaOne.value) + '&server_id=' + obj.Goodle.value)
						};
						">
						<option value="0" selected="selected">Goodle</option>
						<option value="1">Astraios</option>
						<option value="2">Eos</option>
					</select>
				</div>
			</form>
			<form name="MetaAllForm">
				<h3>所有交易品一覧</h3>
				<div class="Sidebar">
					<input type="button" value="キーワードの交易品を追加" style="width:90%; margin: 1%" onClick="AddMetarial(document.MetaOneForm.MetaOne.value)">
					<input type="button" value="and検索" style="width:5em; clear: both; margin: 1%" onClick="RecipeSearch('and')">
					<input type="button" value="or検索"  style="width:5em; clear: both; margin: 1%" onClick="RecipeSearch('or')">
					<input type="button" class="clear" value=" × " onClick="ClearAllSelect()"><br>
				</div>
				<div id="ItemList"><script type="text/javascript">Meta.WriteSelectList(window)</script></div>
			</form>
		</div>
		<div id="main">
			<form name="Results">
				<h3 id="Filter">検索結果 / <small>並び替え:
					<input type="button" value="行動(昇順)" onClick="Recipe.SortResults('HP','asc');WriteAnswer('off')">
					<input type="button" value="行動(降順)" onClick="Recipe.SortResults('HP','desc');WriteAnswer('off')">
					<input type="button" value="Rank(昇順)" onClick="Recipe.SortResults('Rank','asc');WriteAnswer('off')">
					<input type="button" value="Rank(降順)" onClick="Recipe.SortResults('Rank','desc');WriteAnswer('off')">
					<input type="button" value="解除" onClick="Recipe.SortResults('','asc');WriteAnswer('on')"><br>
					絞り込み：
					<input type="checkbox" name="Refine" onclick="WriteAnswer('inherit')" id="Food" value="Food" checked>単品
					<input type="checkbox" name="Refine" onclick="WriteAnswer('inherit')" id="Party" value="Party" checked>艦隊
					<input type="checkbox" name="Refine" onclick="WriteAnswer('inherit')" id="Trade" value="Trade" checked>交易品
					<input type="checkbox" name="Refine" onclick="WriteAnswer('inherit')" id="Adjutant" value="Adjutant" checked>副官
					<input type="checkbox" name="Refine" onclick="WriteAnswer('inherit')" id="Pet" value="Pet" checked>ペット
					<input type="checkbox" name="Refine" onclick="WriteAnswer('inherit')" id="Item" value="Item" checked>アイテム
					<input type="checkbox" name="Refine" onclick="WriteAnswer('inherit')" id="Ship" value="Ship" checked>船部品
					<!-- 種類：Trade(交易品),Party(艦隊効果),Scurvy(壊血病),Pet(ペット),Ship(造船部品),Item(アイテム) -->

					/ 回復量：<select id="Action" onchange="WriteAnswer('inherit')">
						<option value="00" selected="selected">全て</option>
						<option value="59">60未満</option>
						<option value="60">60以上</option>
					</select>
				</small></h3>
			</form>
			<div id="Answer1">
				<script type="text/javascript">
					var Query = new Array;
					Query = GetAllQuery();
					if (typeof Query['q'] != "undefined" ) {
						KeySearch(Query['q']);
					}else{
						KeySearch('');
					}
				</script>
			</div>
			<p id="Brows"><b>PC</b> | <a href="./phone.html">Phone</a></p>
		</div>
	</div>
	<div id="footer">
		<hr>
		大航海時代Online調理レシピ検索+ Copyright 2009-2012 By <a href="../">SAKA.</a><br>
		Copyright Prototype JavaScript framework & Escape Codec Library.<br>
		<br>
	</div>
	</body>
</html>
